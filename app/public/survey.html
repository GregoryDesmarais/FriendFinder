<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Friend Finder!</title>
    <script src='https://code.jquery.com/jquery-3.4.1.min.js'></script>
    <link rel='stylesheet' href='https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css' integrity='sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T' crossorigin='anonymous'>
</head>

<body class='mx-5'>
    <div class="jumbotron text-center">
        <h1>Friend Finder!</h1>
        <h3>Fill out the survey below to find a friend!</h3>
    </div>
    <div class="container">
        <div class="col">
            <div class="row-fluid">
                <form>
                    <div class="form-group">
                        <label for="userName">
                            <h3>Name</h3>
                        </label>
                        <input type="text" class="form-control" id="name" name="name" aria-describedby="nameHelp" placeholder="Enter name" required>
                    </div>
                    <div class="form-group">
                        <label for="userPic">
                            <h3>Picture URL</h3>
                        </label>
                        <input type="text" class="form-control" id="photo" name="photo" placeholder="URL to image" required>
                    </div>
                    <h3>Questions</h3>
                    <div class='questionContainer'></div>
                    <button type="submit" class="btn btn-primary" id="submit">Submit</button>
                </form>
            </div>
        </div>
    </div>

    <div class="modal" tabindex="-1" role="dialog" id='result'>
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Found a Friend!</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary">Thanks!</button>
                </div>
            </div>
        </div>
    </div>
    <hr>
    <p><a href="/api/friends">API Friends List</a></p>
    <script>
        const questions = [
            "I have a vivid imagination",
            "I worry about things",
            "I love large parties",
            "I get angry easily",
            "I radiate joy.",
            "I dislike being the center of attention",
            "I try to follow the rules",
            "I like music",
            "I work hard.",
            "I trust what people say."
        ];

        $(function() {

            for (x in questions) {
                $(".questionContainer").append(`
                <div class="form-group">
                <label for="question${x}"><h5>${questions[x]}</h5></label>
                <select class="form-control" id="question${x}" required>
                <option value="" selected>Please Choose</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10 (Strongly Agree)</option>
                </select>
                </div>`)
            }
        });

        $("#submit").on("click", function(e) {
            e.preventDefault();
            const newFriend = {
                name: $("#name").val().trim(),
                photo: $("#photo").val().trim(),
                scores: [
                    parseInt($("#question0").val()),
                    parseInt($("#question1").val()),
                    parseInt($("#question2").val()),
                    parseInt($("#question3").val()),
                    parseInt($("#question4").val()),
                    parseInt($("#question5").val()),
                    parseInt($("#question6").val()),
                    parseInt($("#question7").val()),
                    parseInt($("#question8").val()),
                    parseInt($("#question9").val())
                ]
            }
            console.log(newFriend);
            $.post("/api/friends", newFriend).then(function(res) {
                console.log(res);
            })

        })
    </script>
</body>

</html>